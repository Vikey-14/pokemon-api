name: 🐳 Docker Build

on:
  push:
    branches: [main]
  pull_request:

jobs:
  docker-build:
    runs-on: ubuntu-latest

    steps:
      - name: 📥 Checkout repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: 🗂️ Print full workspace directory tree
        run: |
          echo "::group::CI Workspace Tree"
          find . -type f | sort
          echo "::endgroup::"

      - name: 🐳 Build Docker image (no secrets passed as build-args)
        run: |
          docker build -t pokecenter-api -f Dockerfile .

      # ✅ Uncomment to enable DockerHub push
      # - name: 📤 Push Docker image to Docker Hub
      #   if: false  # change to true to enable
      #   env:
      #     DOCKER_USERNAME: ${{ secrets.DOCKER_USERNAME }}
      #     DOCKER_PASSWORD: ${{ secrets.DOCKER_PASSWORD }}
      #   run: |
      #     echo "${DOCKER_PASSWORD}" | docker login -u "${DOCKER_USERNAME}" --password-stdin
      #     docker tag pokecenter-api:latest $DOCKER_USERNAME/pokecenter-api:latest
      #     docker push $DOCKER_USERNAME/pokecenter-api:latest
